---
phase: 01-core-bot-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - performance_tracker.py
autonomous: true

must_haves:
  truths:
    - "Bot starts and runs continuously without crashing"
    - "Bot logs output to both console and file"
    - "Bot exits cleanly on Ctrl+C"
  artifacts:
    - path: "performance_tracker.py"
      provides: "Standalone bot skeleton with main loop"
      min_lines: 80
  key_links:
    - from: "performance_tracker.py"
      to: "~/.env"
      via: "dotenv load"
      pattern: "load_dotenv.*expanduser"
    - from: "performance_tracker.py"
      to: "~/polybot/tracker.log"
      via: "TeeLogger"
      pattern: "TeeLogger.*tracker\\.log"
---

<objective>
Create the performance tracker bot skeleton with main loop infrastructure.

Purpose: Establish the foundation for a standalone bot that will run alongside the trading bot.
Output: A working `performance_tracker.py` that starts, logs, and runs continuously.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-core-bot-infrastructure/01-RESEARCH.md

# Reference patterns from existing bot
@trading_bot_smart.py (lines 1-120 for TeeLogger, signal handler, dotenv patterns)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create bot skeleton with version, logging, and main loop</name>
  <files>performance_tracker.py</files>
  <action>
Create `performance_tracker.py` in the project root with:

1. **Version block** (lines 1-15):
   - BOT_VERSION dict with version "v0.1", codename "Silent Observer", date, changes
   - Docstring explaining this is a performance tracker (not trader)

2. **Imports** (lines 16-30):
   - os, sys, signal, time, json
   - datetime, timezone from datetime
   - ZoneInfo from zoneinfo (PST = ZoneInfo("America/Los_Angeles"))
   - load_dotenv from dotenv

3. **TeeLogger class** (lines 32-45):
   - Copy exact pattern from trading_bot_smart.py lines 62-71
   - LOG_FILE = os.path.expanduser("~/polybot/tracker.log")
   - Redirect both stdout and stderr

4. **Startup banner** (lines 47-55):
   - Print version info, codename, start time in PST
   - Print log file location

5. **Environment loading** (lines 57-62):
   - load_dotenv(os.path.expanduser("~/.env"))
   - Load WALLET_ADDRESS (will be needed in Phase 2)

6. **Signal handler** (lines 64-70):
   - Graceful Ctrl+C handling
   - Print exit message and sys.exit(0)

7. **Main loop skeleton** (lines 72-end):
   ```python
   def main():
       print("Performance Tracker starting main loop...")

       while True:
           cycle_start = time.time()

           try:
               # TODO: Window detection (Plan 02)
               # TODO: Position detection (Phase 2)
               # TODO: Grading (Plan 03)

               print(f"[{datetime.now(PST).strftime('%H:%M:%S')}] tick")

               # Maintain 1-second loop
               elapsed = time.time() - cycle_start
               time.sleep(max(0, 1 - elapsed))

           except Exception as e:
               print(f"ERROR: {e}")
               time.sleep(1)

   if __name__ == "__main__":
       main()
   ```

Do NOT include any trading logic, CLOB client, or position detection yet. This is purely the skeleton.
  </action>
  <verify>
Run locally: `python3 performance_tracker.py`
- Should print startup banner with version
- Should print "tick" every second
- Ctrl+C should print exit message and stop cleanly
- Check ~/polybot/tracker.log exists and has output
  </verify>
  <done>
Bot runs continuously, logs to file and console, handles Ctrl+C gracefully.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add HTTP session and requests setup</name>
  <files>performance_tracker.py</files>
  <action>
Add HTTP session configuration for API calls (to be used in Plan 02):

1. **Add requests import** after other imports:
   ```python
   import requests
   ```

2. **Add HTTP session** after environment loading (before signal handler):
   ```python
   # HTTP session with connection pooling
   http_session = requests.Session()
   http_session.headers.update({
       'User-Agent': 'PerformanceTracker/0.1'
   })
   ```

3. **Add placeholder constants** for window timing:
   ```python
   # Window timing constants
   WINDOW_DURATION_SECONDS = 900  # 15 minutes
   ```

This prepares the bot for API calls in Plan 02 without adding the actual API logic yet.
  </action>
  <verify>
Run: `python3 performance_tracker.py`
- No import errors
- Still runs and prints ticks
  </verify>
  <done>
HTTP session configured and ready for API calls.
  </done>
</task>

</tasks>

<verification>
1. `python3 performance_tracker.py` runs without errors
2. Startup banner shows version "v0.1" and codename "Silent Observer"
3. Logs appear in both console and ~/polybot/tracker.log
4. Ctrl+C exits cleanly with message
5. No trading logic, no CLOB client, no position detection (pure skeleton)
</verification>

<success_criteria>
- performance_tracker.py exists with ~80-100 lines
- Bot runs continuously printing ticks
- TeeLogger writes to ~/polybot/tracker.log
- Graceful shutdown on Ctrl+C
- HTTP session ready for API calls
</success_criteria>

<output>
After completion, create `.planning/phases/01-core-bot-infrastructure/01-01-SUMMARY.md`
</output>
